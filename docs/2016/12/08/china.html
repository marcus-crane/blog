<!DOCTYPE html>
<html lang="en">
  <title>UTF-9000</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="/css/style.css" type="text/css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.css" type="text/css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css" type="text/css" rel="stylesheet">

<body>
  


  <header>
    <a href="/"><i class="fa fa-chevron-left"></i></a>
    <div id="title">
      <h1>Dear China, Can you please stop? Thanks</h1>
      <h2>I wish their devices would stop being so rude.</h2>
      <h3>December 8, 2016</h3>
    </div>
  </header>





  <div id="wrapper">
    <section class="post">
  <article>
    <h2 id="the-one-time-i-actually-looked-at-our-router-logs">The one time I actually looked at our router logs</h2>

<p>Seeing as I’m currently “funemployed” with my previous contract having ended toward the end of last week, I’ve been in the bad habit of staying up late. Well, staying up early rather.</p>

<p>The router in our flat had cut out one night at about 4am while I was reading up on some stuff so I thought nothing much of it and went to bed.</p>

<p>The next night, it happened again which I thought was odd timing so for once, I actually remembered that the router would be saving logs somewhere.</p>

<h2 id="what-the-heck-is-all-this">What the heck is all this?</h2>

<p><a href="/img/china/logs.png"><img src="/img/china/logs.png" alt="The logs from our Nighthawk router" /></a></p>

<p>Well, holy shit. That’s a lot of pings.</p>

<p>I will point out that <code class="highlighter-rouge">202.78.144.60</code> is the static IP address for our router (and the IP address from which this blog is served) so it doesn’t count but everything else was completely foreign to me.</p>

<p>My first assumption was that it was probably some misconfigured IoT device somewhere in the world that had been infected.</p>

<p>I couldn’t say for sure but it really wouldn’t surprise me after seeing how many devices earlier this year had been infected by <a href="https://en.wikipedia.org/wiki/Mirai_(malware)">Mirai</a> in the two large DDoS attacks earlier this year.</p>

<h2 id="lets-find-out-some-more-info">Let’s find out some more info</h2>

<p><a href="/img/china/abuseipdb.png"><img src="/img/china/abuseipdb.png" alt="A screenshot of Abuse IPDB showing the source as being from China" /></a></p>

<p>All of the addresses that I had a look at live somewhere in China. This one is allegedly in <a href="https://en.wikipedia.org/wiki/Nanjing">Nanjing</a> while another was in <a href="https://en.wikipedia.org/wiki/Shenzhen">Shenzhen</a> but who knows what effect the <a href="https://en.wikipedia.org/wiki/Great_Firewall">Great Firewall</a> could be having on geolocation.</p>

<p><a href="/img/china/whois.png"><img src="/img/china/whois.png" alt="The whois segment from Abuse IPDB" /></a></p>

<p>The whois segment gave some possible contact details so I tried sending them a nice friendly email to ask that they find whatever user or device is sending out these pings and disable it.</p>

<h2 id="can-we-ask-them-to-stop">Can we ask them to stop?</h2>

<p><a href="/img/china/bounceback.png"><img src="/img/china/bounceback.png" alt="The email I sent bounced back" /></a></p>

<p>Probably not very surprising but two of the three addresses I tried resulted in failed attempts. Email concepts aren’t my strong point but it seems that they don’t have any <a href="https://en.wikipedia.org/wiki/Sender_Policy_Framework">SPF</a> records configured.</p>

<p>Well, next stop is just talking to the mail server itself and seeing what it says about the email addresses in question!</p>

<p><a href="/img/china/relay-denied.png"><img src="/img/china/relay-denied.png" alt="A terminal window with the mail server saying Relay access denied" /></a></p>

<p>I remembered a neat trick I learnt a week or two back where you can get the mail records for a domain using <code class="highlighter-rouge">nslookup -q=MX [domain]</code> and then just manually connect to them using <code class="highlighter-rouge">telnet [mail server] [port (usually 25)]</code>.</p>

<p>In particular, I just use it for seeing if email addresses exist or not (eg; for job applications) without having to actually send off an email.</p>

<p>In this case, it came in handy for seeing that the relay itself just didn’t want anything at all to do with me. I’m going to assume it’s because I’m trying to access it from outside of China but that’s 100% pure speculation and I have no idea what <code class="highlighter-rouge">Relay Access Denied</code> means beyond what it says on the tin.</p>

<h2 id="what-else-can-we-find-out">What else can we find out?</h2>

<p>Well, the last thing to try is good ol’ <code class="highlighter-rouge">nmap</code>. Admittedly, it was the first thing I tried (most of this post is out of chronological order) but it also was the most surprising.</p>

<p>The first scan I did took 3 minutes and didn’t show much. Next, I ran two OS scans (<code class="highlighter-rouge">sudo nmap -O [ip]</code>), one on my own computer and one from a much faster <a href="amazonaws.com">AWS</a> server.</p>

<p>The AWS server finished first but didn’t have much to show. The scan on my own computer took 30(!!!) minutes to complete. I know routing can be a bit slow with the firewall and all but holy heck!</p>

<p>All I can say is, the results I got back were something I never expected</p>

<h2 id="get-ready-for-a-wall-of-text-in-image-form">Get ready for a wall of text (in image form)</h2>

<p><a href="/img/china/nmap-p1.png"><img src="/img/china/nmap-p1.png" alt="Part 1 of the nmap scan" /></a></p>

<p><a href="/img/china/nmap-p2.png"><img src="/img/china/nmap-p2.png" alt="Part 2 of the nmap scan" /></a></p>

<p><a href="/img/china/nmap-p3.png"><img src="/img/china/nmap-p3.png" alt="Part 3 of the nmap scan" /></a></p>

<p><a href="/img/china/nmap-p4.png"><img src="/img/china/nmap-p4.png" alt="Part 4 of the nmap scan" /></a></p>

<p><a href="/img/china/nmap-p5.png"><img src="/img/china/nmap-p5.png" alt="Part 5 of the nmap scan" /></a></p>

<p>Seeing as I’m a hobbyist, I don’t really use <code class="highlighter-rouge">nmap</code> that much but I’ve never seen so many open ports in my life!</p>

<p>Interestingly enough, there’s a heap of ports lower than <code class="highlighter-rouge">1024</code> open as well which generally require admin privileges to bind to.</p>

<p>Apparently, the services listed are just what <code class="highlighter-rouge">nmap</code> associated with each port but isn’t necessarily what is running out of them. As far as learning about services though, this seems like a decent list to run off of.</p>

<h2 id="get-us-outta-here-scotty">Get us outta here, scotty</h2>

<p>While the scan points to possibly a network switch, router, printer or even IoT thermometer of some sort, there’s not really much I can do about it unfortunately.</p>

<p>In the grand scheme of things though, this is likely happening to every other device connected to the internet anyway and it doesn’t really doing any harm.</p>

<p>It does make me wonder how many devices there must be to provide full coverage against my address almost every minute of the day when there’s just under 4.3 billion other IPv4 address that they could be hassling!</p>

  </article>
</section>

  </div>

  <footer>
  <p>
    <a href="mailto:marcus@thingsima.de">
      <i class="fa fa-envelope"></i>
    </a>
    <a href="https://github.com/marcus-crane">
      <i class="fa fa-github"></i>
    </a>
    <a href="https://linkedin.com/in/placeholderurl">
      <i class="fa fa-linkedin"></i>
    </a>
    <a href="https://steamcommunity.com/id/sandtree">
      <i class="fa fa-steam"></i>
    </a>
    <a href="https://twitter.com/ethernetsalad">
      <i class="fa fa-twitter"></i>
    </a>
  </p>
</footer>

  <script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '5846bc99c88d9013c500bbf3');
    t.setAttribute('data-track-path', 'https://track.gaug.es/track.gif');
    t.src = 'https://d36ee2fcip1434.cloudfront.net/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>
</body>
</html>

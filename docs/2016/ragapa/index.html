<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> What&#39;s the deal with RaGaPa? | UTF-9000 </title> <meta name="description" content=" Sometimes I get lost in cyberspace so it&#39;s about time I share my findings! "> <meta name="keywords" content="utf-9000, junior developer, cyberspace"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Marcus Crane"> <meta property="article:section" content="networking"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2016-11-30 00:00:00 +1300"> <meta property="og:url" content="http://localhost:4000/2016/ragapa/"> <meta property="og:title" content=" What&#39;s the deal with RaGaPa? | UTF-9000 "> <meta property="og:image" content="http://localhost:4000"> <meta property="og:description" content=" Sometimes I get lost in cyberspace so it&#39;s about time I share my findings! "> <meta property="og:site_name" content="Marcus Crane"> <meta property="og:locale" content="en_NZ"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@ethernetsalad"> <meta name="twitter:title" content=" What&#39;s the deal with RaGaPa? | UTF-9000 "> <meta name="twitter:description" content=" Sometimes I get lost in cyberspace so it&#39;s about time I share my findings! "> <meta name="twitter:image:src" content="http://localhost:4000"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" What&#39;s the deal with RaGaPa? | UTF-9000 "> <meta itemprop="description" content=" Sometimes I get lost in cyberspace so it&#39;s about time I share my findings! "> <meta itemprop="image" content="http://localhost:4000"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- Canonical link tag --> <link rel="canonical" href="http://localhost:4000/2016/ragapa/"> <link rel="alternate" type="application/rss+xml" title="UTF-9000" href="http://localhost:4000/feed.xml"> <script type="text/javascript"> var disqus_shortname = ''; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-52446115-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><span><a href="/">UTF-9000</span></a></h1> <ul class="navbar"> <!--<li><a href="/about">about</a></li>--> <li><a href="/feed.xml" target="_blank">feed</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">What's the deal with RaGaPa?</h1> <p class="post-meta"><time datetime="2016-11-30T00:00:00+13:00" itemprop="datePublished">Nov 30, 2016</time></p> </header> <div class="post-content" itemprop="articleBody"> <h2 id="what-the-heck-is-this-rubbish">What the heck is this rubbish?</h2> <p>So, I’m sitting at the library using the public WiFi and I visit an unsecured site.</p> <p><a href="/assets/img/ragapa/mot-injection.png"><img src="/assets/img/ragapa/mot-injection.png" alt="Ministry of Transport face with injection in front of it" /></a></p> <p>Bam, injected ad frame. What?!? I run Common Sense 2016, the most up to date antivirus available!</p> <p><a href="/assets/img/ragapa/thingsimade-injection.png"><img src="/assets/img/ragapa/thingsimade-injection.png" alt="Even my own site had it since I disabled https" /></a></p> <p>Even my own site is suffering from this rather ugly defacement! Bah, and people think I’m silly for enabling https even on my static sites. If a site has it enabled, these ads can’t insert themselves midway.</p> <p>I realised later on that I had removed <a href="https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm?hl=en">uBlock Origin</a> while testing out some different extensions, and forgotten to reinstall it, which is why I’d never seen these injections before.</p> <h2 id="if-its-not-me-maybe-its-the-network">If it’s not me, maybe it’s the network!</h2> <p>I had a look in my extensions. Nothing out of place there. A quick poke around the most obvious places turned up zilch so perhaps it was someone, or something on the network?</p> <p>I spun up <a href="https://wireshark.org">Wireshark</a> and watched the network spew out heaps of requests. It was a public city WiFi after all but thankfully, you can filter by <code>http</code> to gain some more clarity.</p> <p>Oooh, what’s that?</p> <p><a href="/assets/img/ragapa/wireshark.png"><img src="/assets/img/ragapa/wireshark.png" alt="The Wireshark captures from Wellington Library" /></a></p> <p>Hmm, <code>GET /api/adscript.jsp</code>? That looks promising.</p> <p>Perhaps an infected device is serving it up? What if it’s someone hijacking unsecured requests and inserting their own monetisation? I gotta know more!</p> <p>Thanks to my rookie skills with nmap, I remembered that I could run a scan on it, not just for open ports but also details about its OS as well.</p> <p><a href="/assets/img/ragapa/cbdfree-nmap.png"><img src="/assets/img/ragapa/cbdfree-nmap.png" alt="nmap output from the Wellington Library scan" /></a></p> <p><code>Too many fingerprints match this host to give specific OS details.</code> Well, so much for that approach.</p> <p>Maybe the actual ad script itself can give me some clues?</p> <h2 id="its-usually-quicker-if-you-look-at-whats-right-in-front-of-you">It’s usually quicker if you look at what’s right in front of you</h2> <p>I loaded up a non-secure site and poked around the DOM.</p> <p><a href="/assets/img/ragapa/script.png"><img src="/assets/img/ragapa/script.png" alt="Developer tools in Google Chrome showing injected Javascript" /></a></p> <p>Oh… That address has <a href="http://www.citylink.co.nz/">Citylink Wellington</a> in it who run the actual network itself. I guess it’s nothing malicious after all but still a pain in the ass.</p> <p>I kept coming across <code>ragapa</code> references, such as <code>div class=ragapaBottomImage</code> and <code>script src=http://adapi.ragapa.com</code> but in wanting to play with Wireshark, I skipped the obvious path of just searching the name. How is that any fun though!</p> <p>It didn’t take me long before I found an article about RaGaPa.</p> <p><a href="/assets/img/ragapa/ragapa-article.png"><img src="/assets/img/ragapa/ragapa-article.png" alt="An article about the RaGaPa ad injection device" /></a></p> <p>They’re a company who provide devices that inject ads into WiFi hotspots. In this case, the entire city wide WiFi hotspot called <code>cbdfree</code>.</p> <h2 id="i-want-to-make-it-go-away">I want to make it go away.</h2> <p>Well, the good news is that there are ad blockers for exactly that! Chances are, if you use Adblock, you’re using Easylist which was merged with a list maintained by New Zealand’s very own <a href="https://fanboy.co.nz/">Fanboy List</a>. He actually had RaGaPa’s site in his list so more or less every instance of Adblock will block it by default.</p> <aside class="share"> <h5>You can share this on <a href="http://twitter.com/share?text=I liked this post called What's the deal with RaGaPa? from" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2016/ragapa/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=235');return false;">Facebook</a> </h5> </aside> </div> </article> <footer class="site-footer"> <div class="container"> <small class="pull-left">&copy;2017 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>, <a href="https://github.com/nandomoreirame/simplest" target="_blank">Simplest</a> and ♥</small> <small class="pull-right"></small> </div> </footer> </main> </body> </html>
